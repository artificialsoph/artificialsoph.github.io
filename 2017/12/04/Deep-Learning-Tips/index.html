<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="I often find myself in roughly this situation:  I’ve done a lot of work to pre-process data, researched different DL architectures and selected one (or more), m">
<meta property="og:type" content="article">
<meta property="og:title" content="Deep Learning Tips">
<meta property="og:url" content="http://soph.info/2017/12/04/Deep-Learning-Tips/index.html">
<meta property="og:site_name">
<meta property="og:description" content="I often find myself in roughly this situation:  I’ve done a lot of work to pre-process data, researched different DL architectures and selected one (or more), modified it so that it works well on my d">
<meta property="og:image" content="http://soph.info/images/tips/tb.png">
<meta property="og:updated_time" content="2017-12-04T18:48:20.488Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deep Learning Tips">
<meta name="twitter:description" content="I often find myself in roughly this situation:  I’ve done a lot of work to pre-process data, researched different DL architectures and selected one (or more), modified it so that it works well on my d">
<meta name="twitter:image" content="http://soph.info/images/tips/tb.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/h.png">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/h.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/h.png">
          
        
    
    <!-- title -->
    <title>Deep Learning Tips</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2017/10/18/scratch/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://soph.info/2017/12/04/Deep-Learning-Tips/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&text=Deep Learning Tips"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&is_video=false&description=Deep Learning Tips"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Deep Learning Tips&body=Check out this article: http://soph.info/2017/12/04/Deep-Learning-Tips/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&name=Deep Learning Tips&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Clean-up-training-code-and-improve-logging"><span class="toc-number">1.</span> <span class="toc-text">Clean up training code and improve logging.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Learning-Rate-Schedule"><span class="toc-number">2.</span> <span class="toc-text">Learning Rate Schedule</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Use-noise-and-other-transformations-to-enlarge-your-datasets"><span class="toc-number">3.</span> <span class="toc-text">Use noise and other transformations to enlarge your datasets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimize"><span class="toc-number">4.</span> <span class="toc-text">Optimize</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Deep Learning Tips
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name"></span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-12-04T18:15:11.000Z" itemprop="datePublished">2017-12-04</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>I often find myself in roughly this situation:</p>
<blockquote>
<p>I’ve done a lot of work to pre-process data, researched different DL architectures and selected one (or more), modified it so that it works well on my data.<br>And now I’ve got a model that does well, but not quite as well as I want it to.</p>
</blockquote>
<p>Below I’ll outline steps that I find very useful in this situation. Of course, more detail about how to get to that point is for another post. Also, I’m using Keras so many of these are specific to that tool, but they could absolutely be applied to other DL packages.</p>
<h2 id="Clean-up-training-code-and-improve-logging"><a href="#Clean-up-training-code-and-improve-logging" class="headerlink" title="Clean up training code and improve logging."></a>Clean up training code and improve logging.</h2><p>My typical workflow when I’m building or tweaking a model by hand is to run Kears in a Jupyter notebook. This works fine if the entire pipeline runs in a few minutes but doesn’t work if I need to close my laptop while the pipeline is running. Jupyter often has trouble gracefully reconnecting and then I lose all the <code>verbose</code> info.</p>
<p>Porting my code into a self-contained python script allows me to connect to a machine over mosh and tmux, run the script, and then forget about it. This is handy on it’s own but it’ll be extremely handy when we get to the later tips.</p>
<p>The tools I use for this are:</p>
<ul>
<li><a href="https://keras.io/callbacks/#csvlogger" target="_blank" rel="noopener"><code>keras.callbacks.CSVLogger(...)</code></a></li>
<li><a href="https://keras.io/callbacks/#tensorboard" target="_blank" rel="noopener"><code>keras.callbacks.TensorBoard(...)</code></a></li>
<li><a href="https://keras.io/callbacks/#modelcheckpoint" target="_blank" rel="noopener"><code>keras.callbacks.ModelCheckpoint(..., save_best_only=True)</code></a></li>
</ul>
<p><code>CSVLogger</code> takes the output from verbose and stores it in a csv file for later. If you’re using tmux, it should be preserving your terminal log (and the <code>verbose</code> output) but csv puts all of that history data in a format where you can easily use it.</p>
<p><code>TensorBoard</code> is super handy if you want to be able to monitor the progress of a long-running model from somewhere other than your terminal. I can access this from my iPad and it looks great!<br><img src="/images/tips/tb.png" alt=""></p>
<p><code>ModelCheckpoint</code> saves your model every so often (you set the frequency as a parameter). This is nice on its own because it allows you to access a model that was trained in a script from anywhere (including my preferred tinkering environment, Jupyter). Even more than that, if you use <code>save_best_only=True</code>, then the script is automatically saving space by only saving the best performing model (you should youse <code>val_loss</code> or some other validation metric with this option).</p>
<h2 id="Learning-Rate-Schedule"><a href="#Learning-Rate-Schedule" class="headerlink" title="Learning Rate Schedule"></a>Learning Rate Schedule</h2><ul>
<li><a href="https://keras.io/callbacks/#learningratescheduler" target="_blank" rel="noopener"><code>keras.callbacks.LearningRateScheduler</code></a></li>
<li><a href="https://keras.io/callbacks/#reducelronplateau" target="_blank" rel="noopener"><code>keras.callbacks.ReduceLROnPlateau</code></a> This is my preference. I use this in conjunction with EarlyStopping and ModelCheckpoint all the time.</li>
</ul>
<h2 id="Use-noise-and-other-transformations-to-enlarge-your-datasets"><a href="#Use-noise-and-other-transformations-to-enlarge-your-datasets" class="headerlink" title="Use noise and other transformations to enlarge your datasets"></a>Use noise and other transformations to enlarge your datasets</h2><ul>
<li><a href="https://keras.io/preprocessing/image/#imagedatagenerator" target="_blank" rel="noopener">keras.preprocessing.image.ImageDataGenerator()</a></li>
<li><a href="https://www.tensorflow.org/versions/master/tutorials/audio_recognition#background_noise" target="_blank" rel="noopener">Tensorflow blog discussing this with background noise</a></li>
</ul>
<h2 id="Optimize"><a href="#Optimize" class="headerlink" title="Optimize"></a>Optimize</h2><p>There are many hyperparameters that can be optimized:</p>
<ul>
<li>Learning rate</li>
<li>Dropout rate</li>
<li>Preprocessing steps</li>
<li>Different architectures (size and shape of layers as well as count) and parameters</li>
<li>Regularizers and parameters</li>
<li>Initializers and parameters</li>
<li>and more!</li>
</ul>
<p>These create an enormous space of possible models for which to test. My recommendation is to find something that works and then from that functioning model determine plausible options for the above hyperparameters. Then throw what you have into hyperopt.</p>
<ul>
<li><a href="https://github.com/hyperopt/hyperopt" target="_blank" rel="noopener">HyperOpt does this automatically</a>. It’s poorly documented but fairly easy to use.</li>
</ul>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Clean-up-training-code-and-improve-logging"><span class="toc-number">1.</span> <span class="toc-text">Clean up training code and improve logging.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Learning-Rate-Schedule"><span class="toc-number">2.</span> <span class="toc-text">Learning Rate Schedule</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Use-noise-and-other-transformations-to-enlarge-your-datasets"><span class="toc-number">3.</span> <span class="toc-text">Use noise and other transformations to enlarge your datasets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimize"><span class="toc-number">4.</span> <span class="toc-text">Optimize</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://soph.info/2017/12/04/Deep-Learning-Tips/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&text=Deep Learning Tips"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&is_video=false&description=Deep Learning Tips"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Deep Learning Tips&body=Check out this article: http://soph.info/2017/12/04/Deep-Learning-Tips/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&title=Deep Learning Tips"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://soph.info/2017/12/04/Deep-Learning-Tips/&name=Deep Learning Tips&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 Sophie Searcy
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-103309791-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


