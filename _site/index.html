<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

    
  <title>soph</title>
  <meta name="description" content="Minimal, responsive Jekyll theme for hackers." />
  

  <!-- Configure mathjax according to https://docs.mathjax.org/en/latest/configuration.html#using-plain-javascript -->
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {
        inlineMath: [["$", "$"], ["\\(", "\\)"]],
        processEscapes: true
      }
    };
  </script>
  <script
    type="text/javascript"
    async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"
  ></script>

  <link rel="stylesheet" href="/assets/soph.css"> <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/" />
   
  <link
    rel="alternate"
    type="application/rss+xml"
    title="soph"
    href="http://localhost:4000/feed.xml"
  />

   
  <meta property="og:type" content="article" />
  <meta property="fb:admins" content="123" />
  <meta property="og:title" content="soph" />
  <meta property="og:site_name" content="soph" />
  <meta property="og:url" content="http://localhost:4000/" />
  <meta property="og:description" content="Minimal, responsive Jekyll theme for hackers." />
  
  <meta property="article:author" content="https://www.facebook.com/defsophiaray" />
   
  <meta property="og:image" content="http://soph.info/images/fb_teach.png" />
    <meta name="twitter:card" content="summary_large_image"> 
  <meta name="twitter:site" content="defsophiaray" />
  
  <meta name="twitter:title" content="soph" />
  <meta
    name="twitter:description"
    content="Minimal, responsive Jekyll theme for hackers."
  />
  
  <meta name="twitter:creator" content="defsophiaray" />
  <meta name="twitter:site" content="defsophiaray" />
   
  <meta name="twitter:image" content="http://soph.info/images/fb_teach.png" />
   <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Bitter:400,700,400italic:latin' ] }
  };
  (function(d) {
    var wf = d.createElement('script'), s = d.scripts[0];
    wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
    wf.async = true;
    s.parentNode.insertBefore(wf, s);
  })(document);
</script>
 
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-103309791-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">soph</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

  

  

  <ul class="post-list">
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/slash-data">Slash dataset: A toy dataset that stymies most non-convolutional models.</a>
            
          </h1>

          <p class="post-meta">
            May 28, 2019
            
              

 ‚Ä¢
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/data-science/">data science</a>,
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/howto/">howto</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <h1>TLDR</h1>

<p>I‚Äôm releasing a dataset ‚ÄúSlash dataset‚Äù that is easy for convolutional neural nets to learn but difficult for most other models.</p>

<p>It will live here: <a href="https://soph.info/data/slash_data.npz">soph.info/data/slash_data.npz</a></p>

<p>Code for generating the dataset and replicating the analysis is at the bottom of this post. Cheers!</p>

<h2>Background</h2>

<p>Convolution is an extremely important mathematical operation. It‚Äôs frequently used in <a href="https://en.wikipedia.org/wiki/Convolution#Applications">digital signal processing</a>, including compression techniques for images and audio, and it‚Äôs the namesake and heart of <a href="https://www.deeplearningbook.org/contents/convnets.html">‚ÄúConvolutional Neural Network‚Äù</a>.</p>

<p>But what actually <em>is</em> a convolution? There are a bunch of mesmerizing gifs like the one below, and there are some good explanations out there, but I think there‚Äôs room to improve.
<img src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Convolution_of_spiky_function_with_box2.gif" alt="" /></p>

<p>I‚Äôm in the middle of a project to explain exactly what convolution does and, specifically, why it‚Äôs so useful for machine learning. As part of that effort, I‚Äôve put together a toy dataset designed to be as simple as possible while also being difficult for all models except for convolutional ones.</p>

<h2>Data</h2>

<p>The dataset includes 1,000 images, each of which include a slash. It is divided into two classes according to whether the slash is downward facing (like the backslash character ‚Äú‚Äù) or upward facing (like the forward slash ). Below is a random selection along with class labels.</p>

<p><img src="/images/conv_data.png" alt="" /></p>

<p>Each image is 30x30 grayscale pixels. I‚Äôve added a little bit of noise to the images to make things interesting.</p>

<h2>Results</h2>

<p>Hopefully by now, you‚Äôre looking at this dataset and thinking ‚Äúgee, that doesn‚Äôt look <em>too</em> difficult‚Äù. This would be a boring task for any human and it might be difficult at first to see why it is so challenging for most models.</p>

<p>I‚Äôm going to save a detailed explanation of exactly why that is for later. For now, I want to share my results: I tested out several off-the-shelf models as well as two convolutional models.</p>

<p>Of the off-the-shelf models, I didn‚Äôt waste my time tuning most of them, as I feel quite confident that even when tuned they would do poorly. (I‚Äôd love to be proved wrong on that üòâ.) The one that I did tune was K-Nearest Neighbors, so you‚Äôll see a result for one with the default parameters as well as one with the best performing parameters ($k=1$).</p>

<p>All of the models perform at or close enough to chance (50%) to dismiss them. KNN does pretty well when we tune it (90% test accuracy) but this performance looks less impressive when we note that KNN is memorizing the entire dataset and then comparing new examples to memorized ones. That strategy is not one that we would expect to hold up in the real world where data is much bigger than a few hundred B&amp;W thumbnail images. Because of this, I‚Äôve listed the trainable parameters for each model.</p>

<p>On the other hand, the ConvNets both get perfect scores on both train and test sets. The <strong>Vanilla CNN</strong> uses the same cookie-cutter structure that I would apply as a first attempt on just about <em>any</em> image data (two rounds of Convolution ‚ÜíBatch Normalization‚ÜíPooling). This Vanilla CNN is not tuned to the particular dataset. The <strong>Custom CNN</strong> is one I built and hand-tuned to demonstrate how ConvNets can really punch above their weight in terms of parameters. This architecture was pretty fragile (tweaking the numbers slightly is likely to break it) when testing but it‚Äôs mostly there to make a point.</p>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>2</th>
      <th>3</th>
      <th>0</th>
      <th>7</th>
      <th>8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Model</th>
      <td>Random Forest</td>
      <td>SVM - Linear</td>
      <td>SVM - RBF kernel</td>
      <td>SVM - Polynomial kernel</td>
      <td>Logistic Regression</td>
      <td>K Nearest Neighbors</td>
      <td>KNN, k=1</td>
      <td>Vanilla CNN</td>
      <td>Custom CNN</td>
    </tr>
    <tr>
      <th>Trainable params</th>
      <td>9183</td>
      <td>498600</td>
      <td>675000</td>
      <td>675000</td>
      <td>901</td>
      <td>675000</td>
      <td>675000</td>
      <td>1041</td>
      <td>80</td>
    </tr>
    <tr>
      <th>Train score</th>
      <td>1</td>
      <td>0.994667</td>
      <td>0.838667</td>
      <td>0.84</td>
      <td>0.98</td>
      <td>0.842667</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Test score</th>
      <td>0.472</td>
      <td>0.5</td>
      <td>0.532</td>
      <td>0.532</td>
      <td>0.54</td>
      <td>0.604</td>
      <td>0.908</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<h2>Methods</h2>

<p>All code used to generate this dataset is included below. Be on the lookout for more Convolution content shortly!</p>

<script src="https://gist.github.com/artificialsoph/b71c1c25b5ea86cb7ad3ab38afcbfb55.js"></script>


        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2019/05/07/imbalance/">An opinionated guide to imbalanced classes</a>
            
          </h1>

          <p class="post-meta">
            May 7, 2019
            
              

 ‚Ä¢
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/data-science/">data science</a>,
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/howto/">howto</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <script src="https://gist.github.com/artificialsoph/6906ff7ca66531a6c660a0cc24355ff4.js"></script>


        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/odsc2019">Building Generative Adversarial Networks In Tensorflow and Keras</a>
            
          </h1>

          <p class="post-meta">
            May 1, 2019
            
              

 ‚Ä¢
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/data-science/">data science</a>,
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/howto/">howto</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/talk/">talk</a>
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <script src="https://gist.github.com/artificialsoph/1032e89227b1fe7707d6ea5e533e0b9c.js"></script>


        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2019/04/12/gif-moviepy-colab/">How to make a gif in Colab</a>
            
          </h1>

          <p class="post-meta">
            Apr 12, 2019
            
              

 ‚Ä¢
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/data/">data</a>,
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/science/">science,</a>,
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/howto/">howto</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <p>I wrote a little demo of how to make a gif in Colab. You can check it out below or you can open it and run it yourself by clicking on the ‚ÄúOpen in Colab‚Äù button at the top.</p>

<script src="https://gist.github.com/artificialsoph/16fca07a56c7d902eda00e67ab37efea.js"></script>


        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2018/11/08/Recent-papers/">Neat papers in ML and DS: Dec 2018</a>
            
          </h1>

          <p class="post-meta">
            Nov 8, 2018
            
              

 ‚Ä¢
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/data/">data</a>,
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/science/">science,</a>,
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/history/">history</a>
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <ul>
  <li><a href="https://arxiv.org/abs/1811.12231">ImageNet-trained CNNs are biased towards texture; increasing shape bias improves accuracy and robustness</a></li>
  <li><a href="https://openreview.net/forum?id=SkfMWhAqYQ">Approximating CNNs with Bag-of-local-Features models works surprisingly well on ImageNet</a></li>
</ul>

<p>NeurIPS</p>
<ul>
  <li><a href="http://papers.nips.cc/paper/7350-are-gans-created-equal-a-large-scale-study">Are GANs Created Equal? A Large-Scale Study</a></li>
  <li><a href="http://papers.nips.cc/paper/8169-an-intriguing-failing-of-convolutional-neural-networks-and-the-coordconv-solution">An intriguing failing of convolutional neural networks and the CoordConv solution</a></li>
  <li><a href="http://papers.nips.cc/paper/7368-on-the-dimensionality-of-word-embedding">On the Dimensionality of Word Embedding</a></li>
  <li><a href="http://papers.nips.cc/paper/7647-adversarial-examples-that-fool-both-computer-vision-and-time-limited-humans">Adversarial Examples that Fool both Computer Vision and Time-Limited Humans</a></li>
  <li><a href="http://papers.nips.cc/paper/8277-bias-and-generalization-in-deep-generative-models-an-empirical-study">Bias and Generalization in Deep Generative Models: An Empirical Study</a></li>
  <li><a href="http://papers.nips.cc/paper/7515-how-does-batch-normalization-help-optimization">How Does Batch Normalization Help Optimization?</a></li>
  <li><a href="http://papers.nips.cc/paper/7957-training-deep-models-faster-with-robust-approximate-importance-sampling">Training Deep Models Faster with Robust, Approximate Importance Sampling</a></li>
  <li><a href="http://papers.nips.cc/paper/7371-dropmax-adaptive-variational-softmax">DropMax: Adaptive Variational Softmax</a></li>
  <li><a href="http://papers.nips.cc/paper/7960-relational-recurrent-neural-networks">Relational recurrent neural networks</a></li>
  <li><a href="http://papers.nips.cc/paper/8027-neural-arithmetic-logic-units">Neural Arithmetic Logic Units</a></li>
</ul>

        </div>
        
      </li>
    
  </ul>

  
  <div class="pagination">
    
      <a class="previous" href="/posts/2/">&laquo; Older</a>
    

    
  </div>



</div>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; Sophia Ray Searcy - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="http://localhost:4000/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
